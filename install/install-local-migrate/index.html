



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for Islandora Enterprise (ISLE)">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Local: Migrate Site - Islandora Enterprise (ISLE)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#local-isle-installation-migrate-existing-islandora-site" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Islandora Enterprise (ISLE)" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Islandora Enterprise (ISLE)
            </span>
            <span class="md-header-nav__topic">
              
                Local: Migrate Site
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Islandora Enterprise (ISLE)" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Islandora Enterprise (ISLE)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Get Started" class="md-nav__link">
      Get Started
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Install ISLE
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Install ISLE
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../host-hardware-requirements/" title="1. Hardware Requirements" class="md-nav__link">
      1. Hardware Requirements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../host-software-dependencies/" title="2. Software Dependencies" class="md-nav__link">
      2. Software Dependencies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-demo/" title="3. Demo ISLE Installation" class="md-nav__link">
      3. Demo ISLE Installation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" checked>
    
    <label class="md-nav__link" for="nav-2-4">
      4. ISLE Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        4. ISLE Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install-environments/" title="Overview: ISLE Environments" class="md-nav__link">
      Overview: ISLE Environments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-local-new/" title="Local: New Site" class="md-nav__link">
      Local: New Site
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Local: Migrate Site
      </label>
    
    <a href="./" title="Local: Migrate Site" class="md-nav__link md-nav__link--active">
      Local: Migrate Site
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#assumptions-prerequisites" class="md-nav__link">
    Assumptions / Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index-of-instructions" class="md-nav__link">
    Index of Instructions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-0-copy-production-data-to-your-personal-computer" class="md-nav__link">
    Step 0: Copy Production Data to Your Personal Computer
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#drupal-site-files-and-code" class="md-nav__link">
    Drupal Site Files and Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drupal-site-database" class="md-nav__link">
    Drupal Site Database
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#export-the-production-mysql-islandora-drupal-database" class="md-nav__link">
    Export the Production MySQL Islandora Drupal Database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fedora-hash-size-conditional" class="md-nav__link">
    Fedora Hash Size (Conditional)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solr-schema-and-islandora-transforms" class="md-nav__link">
    Solr Schema and Islandora Transforms
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strategy-1-easy-run-stock-isle" class="md-nav__link">
    Strategy 1: Easy - Run "Stock" ISLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strategy-2-intermediate-bind-mount-in-existing-transforms-and-schemas" class="md-nav__link">
    Strategy 2: Intermediate - Bind Mount in Existing Transforms and Schemas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strategy-3-advanced-diff-and-merge-current-production-customization-edits-into-isle-configs" class="md-nav__link">
    Strategy 3: Advanced - Diff and Merge Current Production Customization Edits Into ISLE Configs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-choose-a-project-name" class="md-nav__link">
    Step 1: Choose a Project Name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-15-edit-etchosts-file" class="md-nav__link">
    Step 1.5: Edit "/etc/hosts" File
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-setup-git-for-the-isle-project" class="md-nav__link">
    Step 2: Setup Git for the ISLE Project
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-2a-add-customizations-from-step-0-to-the-git-workflow" class="md-nav__link">
    Step 2a: Add Customizations from "Step 0" to the Git Workflow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-git-clone-the-production-islandora-drupal-site-code" class="md-nav__link">
    Step 3: Git Clone the Production Islandora Drupal Site Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-edit-the-env-file-to-change-to-the-local-environment" class="md-nav__link">
    Step 4: Edit the ".env" File to Change to the Local Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-create-new-users-and-passwords-by-editing-localenv-file" class="md-nav__link">
    Step 5: Create New Users and Passwords by Editing "local.env" File
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-create-new-self-signed-certs-for-your-project" class="md-nav__link">
    Step 6: Create New Self-Signed Certs for Your Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-download-the-isle-images" class="md-nav__link">
    Step 7: Download the ISLE Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-launch-process" class="md-nav__link">
    Step 8: Launch Process
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-9-import-the-production-mysql-drupal-database" class="md-nav__link">
    Step 9: Import the Production MySQL Drupal Database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-10-run-islandora-drupal-site-scripts" class="md-nav__link">
    Step 10: Run Islandora Drupal Site Scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-11-test-the-site" class="md-nav__link">
    Step 11: Test the Site
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-12-ingest-sample-objects" class="md-nav__link">
    Step 12: Ingest Sample Objects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next Steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    Additional Resources
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#end-of-local-isle-installation-migrate-existing-islandora-site" class="md-nav__link">
    End of Local ISLE Installation: Migrate Existing Islandora Site
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-staging-new/" title="Staging: New Site" class="md-nav__link">
      Staging: New Site
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-staging-migrate/" title="Staging: Migrate Site" class="md-nav__link">
      Staging: Migrate Site
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-production-new/" title="Production: New Site" class="md-nav__link">
      Production: New Site
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-production-migrate/" title="Production: Migrate Site" class="md-nav__link">
      Production: Migrate Site
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-troubleshooting/" title="Troubleshooting Guide" class="md-nav__link">
      Troubleshooting Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../update/update/" title="Update ISLE" class="md-nav__link">
      Update ISLE
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Appendices
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Appendices
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/data-persistence/" title="Data Persistence in Docker" class="md-nav__link">
      Data Persistence in Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/installing-module-with-composer/" title="Installing a Drupal Module with Composer" class="md-nav__link">
      Installing a Drupal Module with Composer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/installing-module-with-drush/" title="Installing a Drupal Module with Drush" class="md-nav__link">
      Installing a Drupal Module with Drush
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://docs.google.com/document/d/1r-I9n8mUhlJ5Z-X9AO-RrikhzH6I8bTPIL25LmtRbxE" title="Installing on Google Cloud Platform (Google Doc)" class="md-nav__link">
      Installing on Google Cloud Platform (Google Doc)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/configuring-lets-encrypt/" title="Let's Encrypt: Free SSL Certificates" class="md-nav__link">
      Let's Encrypt: Free SSL Certificates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/open-terminal-in-running-container/" title="Opening a Terminal in a Running Container" class="md-nav__link">
      Opening a Terminal in a Running Container
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/sample-it-department-request/" title="Sample IT Department Request Letter" class="md-nav__link">
      Sample IT Department Request Letter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/install-troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      User Stories
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        User Stories
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/user-story-demo-site/" title="Demo ISLE Installation Example User Story" class="md-nav__link">
      Demo ISLE Installation Example User Story
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/user-story-new-site/" title="New Site Example User Story" class="md-nav__link">
      New Site Example User Story
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/user-story-migration-site/" title="Migration Example User Story" class="md-nav__link">
      Migration Example User Story
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../appendices/redhat/" title="Warning about Red Hat Install" class="md-nav__link">
      Warning about Red Hat Install
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Cookbook Recipes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Cookbook Recipes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cookbook-recipes/isle-cheatsheet-docker-commands/" title="ISLE Cheat Sheet: Docker Commands" class="md-nav__link">
      ISLE Cheat Sheet: Docker Commands
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing to ISLE" class="md-nav__link">
      Contributing to ISLE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/about-isle/" title="About ISLE" class="md-nav__link">
      About ISLE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/committers/" title="About Committers" class="md-nav__link">
      About Committers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Contributor Docs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Contributor Docs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributor-docs/mkdocs/" title="Docs: MkDocs" class="md-nav__link">
      Docs: MkDocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributor-docs/spell-checker/" title="Docs: Spell Checker" class="md-nav__link">
      Docs: Spell Checker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributor-docs/style-guide/" title="Docs: Style Guide" class="md-nav__link">
      Docs: Style Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributor-docs/release-process/" title="Release Process" class="md-nav__link">
      Release Process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributor-docs/testing-guide/" title="Testing Guide" class="md-nav__link">
      Testing Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/get-help/" title="Get Help" class="md-nav__link">
      Get Help
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Release Notes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Release Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release-notes/release-1-2-0/" title="Latest release: 1.2.0" class="md-nav__link">
      Latest release: 1.2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      Previous releases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        Previous releases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release-notes/release-1-1-2/" title="1.1.2" class="md-nav__link">
      1.1.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release-notes/release-1-1-1/" title="1.1.1" class="md-nav__link">
      1.1.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release-notes/release-1-1-0/" title="1.1.0" class="md-nav__link">
      1.1.0
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#assumptions-prerequisites" class="md-nav__link">
    Assumptions / Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index-of-instructions" class="md-nav__link">
    Index of Instructions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-0-copy-production-data-to-your-personal-computer" class="md-nav__link">
    Step 0: Copy Production Data to Your Personal Computer
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#drupal-site-files-and-code" class="md-nav__link">
    Drupal Site Files and Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drupal-site-database" class="md-nav__link">
    Drupal Site Database
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#export-the-production-mysql-islandora-drupal-database" class="md-nav__link">
    Export the Production MySQL Islandora Drupal Database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fedora-hash-size-conditional" class="md-nav__link">
    Fedora Hash Size (Conditional)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solr-schema-and-islandora-transforms" class="md-nav__link">
    Solr Schema and Islandora Transforms
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strategy-1-easy-run-stock-isle" class="md-nav__link">
    Strategy 1: Easy - Run "Stock" ISLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strategy-2-intermediate-bind-mount-in-existing-transforms-and-schemas" class="md-nav__link">
    Strategy 2: Intermediate - Bind Mount in Existing Transforms and Schemas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strategy-3-advanced-diff-and-merge-current-production-customization-edits-into-isle-configs" class="md-nav__link">
    Strategy 3: Advanced - Diff and Merge Current Production Customization Edits Into ISLE Configs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-choose-a-project-name" class="md-nav__link">
    Step 1: Choose a Project Name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-15-edit-etchosts-file" class="md-nav__link">
    Step 1.5: Edit "/etc/hosts" File
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-setup-git-for-the-isle-project" class="md-nav__link">
    Step 2: Setup Git for the ISLE Project
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-2a-add-customizations-from-step-0-to-the-git-workflow" class="md-nav__link">
    Step 2a: Add Customizations from "Step 0" to the Git Workflow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-git-clone-the-production-islandora-drupal-site-code" class="md-nav__link">
    Step 3: Git Clone the Production Islandora Drupal Site Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-edit-the-env-file-to-change-to-the-local-environment" class="md-nav__link">
    Step 4: Edit the ".env" File to Change to the Local Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-create-new-users-and-passwords-by-editing-localenv-file" class="md-nav__link">
    Step 5: Create New Users and Passwords by Editing "local.env" File
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-create-new-self-signed-certs-for-your-project" class="md-nav__link">
    Step 6: Create New Self-Signed Certs for Your Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-download-the-isle-images" class="md-nav__link">
    Step 7: Download the ISLE Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-launch-process" class="md-nav__link">
    Step 8: Launch Process
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-9-import-the-production-mysql-drupal-database" class="md-nav__link">
    Step 9: Import the Production MySQL Drupal Database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-10-run-islandora-drupal-site-scripts" class="md-nav__link">
    Step 10: Run Islandora Drupal Site Scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-11-test-the-site" class="md-nav__link">
    Step 11: Test the Site
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-12-ingest-sample-objects" class="md-nav__link">
    Step 12: Ingest Sample Objects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next Steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    Additional Resources
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#end-of-local-isle-installation-migrate-existing-islandora-site" class="md-nav__link">
    End of Local ISLE Installation: Migrate Existing Islandora Site
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="local-isle-installation-migrate-existing-islandora-site">Local ISLE Installation: Migrate Existing Islandora Site</h1>
<p><em>Expectations:  It takes an average of <strong>2-4+ hours</strong> to read this documentation and complete this installation.</em></p>
<p>This Local ISLE Installation builds a local environment for the express purpose of migrating a previously existing Islandora site onto the ISLE platform. If you need to build a brand new local development site, please <strong>stop</strong> and use the <a href="../install-local-new/">Local ISLE Installation: New Site</a>  instead.</p>
<p>This Local ISLE Installation will use a copy of a currently running Production Islandora Drupal website and an empty Fedora repository for endusers to test migration to ISLE and do site development and design with the end goal of deploying to ISLE Staging and Production environments for public use. The final goal would be to cut over from the existing non-ISLE Production and Staging servers to their new ISLE counterparts.</p>
<p>This Local ISLE Installation will allow you to locally view this site in your browser with the domain of your choice (<strong>Example:</strong> "https://yourprojectnamehere.localdomain"), instead of being constrained to the Demo URL ("https://isle.localdomain").</p>
<p>This document has directions on how you can save newly created ISLE code into a git software repository as a workflow process designed to manage and upgrade the environments throughout the development process from Local to Staging to Production. The <a href="../install-environments/">ISLE Installation: Environments</a> documentation offers an overview of the ISLE structure, the associated files, and what values ISLE endusers should use for the ".env", "local.env", etc.</p>
<p>This document <strong>does not</strong> have directions on how you can save previously existing Islandora Drupal code into a git repository and assumes this step has already happened. The directions below will explain how to clone Islandora Drupal code from a previously existing Islandora Drupal git repository that should already be accessible to you.</p>
<p>Please post questions to the public <a href="https://groups.google.com/forum/#!forum/islandora-isle">Islandora ISLE Google group</a>, or subscribe to receive emails. The <a href="../../appendices/glossary/">Glossary</a> defines terms used in this documentation.</p>
<h2 id="assumptions-prerequisites">Assumptions / Prerequisites</h2>
<ul>
<li>
<p>This Local ISLE installation expects that an existing Production Islandora Drupal site will be imported on a personal computer for further ISLE migration testing, Drupal theme development, ingest testing, etc.</p>
</li>
<li>
<p>You will be using ISLE version <strong>1.2.0</strong> or higher.</p>
</li>
<li>
<p>You are using Docker-compose <strong>1.24.0</strong> or higher.</p>
</li>
<li>
<p>You have git installed on your personal computer.</p>
</li>
<li>
<p>You have a previously existing private Islandora Drupal git repository.</p>
</li>
<li>
<p>You have access to a private git repository in <a href="https://github.com">Github</a>, <a href="https://bitbucket.org/">Bitbucket</a>, <a href="https://gitlab.com">Gitlab</a>, etc.</p>
<ul>
<li>If you do not, please contact your IT department for git resources, or else create an account with one of the above providers.</li>
<li><strong>WARNING:</strong> Only use <strong>Private</strong> git repositories given the sensitive nature of the configuration files. <strong>DO NOT</strong> share these git repositories publicly.</li>
</ul>
</li>
<li>
<p><strong>For Microsoft Windows:</strong></p>
<ul>
<li>You have installed <a href="../host-software-dependencies/#windows">Git for Windows</a> and will use its provided "Git Bash" as your command line interface; this behaves similarly to LINUX and UNIX environments. Git for Windows also installs "openssl.exe" which will be needed to generate self-signed SSL certs. (Note: Powershell is not recommended as it is unable to run UNIX commands or execute bash scripts without a moderate degree of customization.)</li>
<li>Set your text editor to use UNIX style line endings for files. (Text files created on DOS/Windows machines have different line endings than files created on Unix/Linux. DOS uses carriage return and line feed ("\r\n") as a line ending, which Unix uses just line feed ("\n").)</li>
<li>In the "local.env" file, you must uncomment the line "# COMPOSE_CONVERT_WINDOWS_PATHS=1". (See Software Dependencies: <a href="../host-software-dependencies/#edit-demoenv-or-localenv">Edit "demo.env" or "local.env"</a>)</li>
</ul>
</li>
</ul>
<hr />
<h2 id="index-of-instructions">Index of Instructions</h2>
<ul>
<li>Step 0: Copy Production Data to Your Personal Computer</li>
<li>Step 1: Choose a Project Name</li>
<li>Step 1.5: Edit "/etc/hosts" File</li>
<li>Step 2: Setup Git for the ISLE Project</li>
<li>Step 3: Git Clone the Production Islandora Drupal Site Code</li>
<li>Step 4: Edit the ".env" File to Change to the Local Environment</li>
<li>Step 5: Create New Users and Passwords by Editing "local.env" File</li>
<li>Step 6: Create New Self-Signed Certs for Your Project</li>
<li>Step 7: Download the ISLE Images</li>
<li>Step 8: Launch Process</li>
<li>Step 9: Import the Production MySQL Drupal Database</li>
<li>Step 10: Run Islandora Drupal Site Scripts</li>
<li>Step 11: Test the Site</li>
<li>Step 12: Ingest Sample Objects</li>
</ul>
<hr />
<h2 id="step-0-copy-production-data-to-your-personal-computer">Step 0: Copy Production Data to Your Personal Computer</h2>
<p>Be sure to run a backup of any current non-ISLE systems prior to copying or exporting any files.</p>
<h3 id="drupal-site-files-and-code">Drupal Site Files and Code</h3>
<ol>
<li>
<p>Copy the <code>/var/www/html/sites/default/files</code> directory from your Production Apache server to an appropriate storage area on your personal computer. You'll move this directory in later steps.</p>
</li>
<li>
<p>Locate and note the previously existing private Islandora Drupal git repository. You'll be cloning this into place once the ISLE project has been cloned in later steps.</p>
</li>
</ol>
<h3 id="drupal-site-database">Drupal Site Database</h3>
<p><strong>Prior to attempting this step, please consider the following:</strong></p>
<ul>
<li>
<p>Drupal website databases can have a multitude of names and conventions. Confer with the appropriate IT departments for your institution's database naming conventions.</p>
</li>
<li>
<p>Recommended that the production databases be exported using the ".sql" /or ".gz" file formats (e.g. "prod_drupal_site_082019.sql.gz") for better compression and minimal storage footprint.</p>
</li>
<li>
<p>If the end user is running multi-sites, there will be additional databases to export.</p>
</li>
<li>
<p>Do not export the "fedora3" database or any system tables (such as "information_schema", "performance_schema", "mysql")</p>
</li>
<li>
<p>If possible, on the production Apache webserver, run <code>drush cc all</code> from the command line on the production server in the <code>/var/www/html</code> directory PRIOR to any db export(s). Otherwise issues can occur on import due to all cache tables being larger than "innodb_log_file_size" allows</p>
</li>
</ul>
<h4 id="export-the-production-mysql-islandora-drupal-database">Export the Production MySQL Islandora Drupal Database</h4>
<ul>
<li>
<p>Export the MySQL database for the current Production Islandora Drupal site in use and copy it to your personal computer (local) in an easy to find place. In later steps you'll be directed to import this file. <strong>Please be careful</strong> performing any of these potential actions below as the process impacts your Production site.</p>
</li>
<li>
<p>If you are not comfortable or familiar with performing these actions, we recommend that you instead work with your available IT resources to do so.</p>
<ul>
<li>To complete this process, you may use a MySQL GUI client or, if you have command line access to the MySQL database server, you may run the following command, substituting your actual user and database names:</li>
<li><strong>Example:</strong> <code>mysqldump -u username -p database_name &gt; prod_drupal_site_082019.sql</code></li>
<li>Copy this file down to your personal computer.</li>
</ul>
</li>
</ul>
<h3 id="fedora-hash-size-conditional">Fedora Hash Size (Conditional)</h3>
<ul>
<li>
<p>Are you migrating an existing Islandora site that has greater than one million objects? </p>
</li>
<li>
<p>If true, then please carefully read about the <a href="../install-troubleshooting/#fedora-hash-size-conditional">Fedora Hash Size (Conditional)</a>.</p>
</li>
</ul>
<h3 id="solr-schema-and-islandora-transforms">Solr Schema and Islandora Transforms</h3>
<p>This data can be challenging depending on the level of customizations to contend with and as such, ISLE maintainers recommends following one of the three (3), "Easy", "Intermediate", and "Advanced" strategies outlined below.</p>
<h4 id="strategy-1-easy-run-stock-isle">Strategy 1: <strong>Easy</strong> - Run "Stock" ISLE</h4>
<p>Don't copy any existing production Solr schemas, GSearch .xslt files, etc., and opt instead to use ISLE's default versions. Import some objects from your existing Fedora repository and see if they display properly in searches as you like.</p>
<h4 id="strategy-2-intermediate-bind-mount-in-existing-transforms-and-schemas">Strategy 2: <strong>Intermediate</strong> - Bind Mount in Existing Transforms and Schemas</h4>
<p>Bind mount in existing transforms and schemas  to override ISLE settings with your current Production version.</p>
<p><strong>WARNING</strong> <em>This approach assumes you are running Solr 4.10.x.; <strong>only attempt</strong> if you are running that version on Production.</em></p>
<ul>
<li>
<p>Copy these current Production files and directory to your personal computer in an appropriate location.</p>
<ul>
<li>Solr <code>schema.xml</code></li>
<li>GSearch <code>foxmltoSolr.xslt</code> file</li>
<li>GSearch <code>islandora_transforms</code></li>
<li>Keep the files you create during this process; you will need them again for <code>Step 2a</code> (below)!</li>
</ul>
</li>
<li>
<p><strong>Please note:</strong> You may need to further review paths in the files mentioned above, and edit them to match ISLE system paths.  </p>
</li>
</ul>
<h4 id="strategy-3-advanced-diff-and-merge-current-production-customization-edits-into-isle-configs">Strategy 3: <strong>Advanced</strong> - Diff and Merge Current Production Customization Edits Into ISLE Configs</h4>
<ul>
<li>
<p>Copy these current production files and directory to your personal computer in an appropriate location.</p>
<ul>
<li>Solr <code>schema.xml</code></li>
<li>GSearch <code>foxmltoSolr.xslt</code> file</li>
<li>GSearch <code>islandora_transforms</code></li>
</ul>
</li>
<li>
<p>Run the Demo ISLE briefly to pull files for modification and correct ISLE system paths.  </p>
</li>
<li>
<p>You can find these paths by running the Demo and copying these files out to an appropriate location.  </p>
<ul>
<li><code>docker cp isle-solr-ld:/usr/local/solr/collection1/conf/schema.xml schema.xml</code>  </li>
<li><code>docker cp isle-fedora-ld:/usr/local/tomcat/webapps/fedoragsearch/WEB-INF/classes/fgsconfigFinal/index/FgsIndex/foxmlToSolr.xslt foxmlToSolr.xslt</code>  </li>
<li><code>docker cp isle-fedora-ld:/usr/local/tomcat/webapps/fedoragsearch/WEB-INF/classes/fgsconfigFinal/index/FgsIndex/islandora_transforms islandora_transforms</code></li>
</ul>
</li>
<li>
<p>Using a "diff" tool (<em>software that allows one to compare and find the differences between two files</em>), compare:  </p>
<ul>
<li>your Production Solr <code>schema.xml</code> file to the ISLE demo <code>schema.xml</code> file.  </li>
<li>your Production GSearch <code>foxmltoSolr.xslt</code> file to the ISLE demo <code>foxmltoSolr.xslt</code> file.  </li>
<li>your Production GSearch <code>islandora_transforms</code> directory to the ISLE demo <code>islandora_transforms</code> directory.</li>
</ul>
</li>
<li>
<p>Look for edits and comments that indicate specific customization and make note of the differences.  </p>
<ul>
<li>Merge in the customizations into the ISLE versions.</li>
<li>Keep the files you create during this merge process; you will need them again for <code>Step 2a</code> (below)!</li>
</ul>
</li>
</ul>
<hr />
<h2 id="step-1-choose-a-project-name">Step 1: Choose a Project Name</h2>
<p>Please choose a project name (concatenated, with no spaces) that describes your institution or your collection platform. You will substitute in your preferred project name whenever the documentation refers to "yourprojectnamehere". (Be creative. Some real-life examples include: arminda, dhinitiative, digital, digitalcollections, digitallibrary, unbound, etc.)</p>
<hr />
<h2 id="step-15-edit-etchosts-file">Step 1.5: Edit "/etc/hosts" File</h2>
<p>Enable the Local ISLE Installation to be viewed locally on a personal computer browser using "yourprojectnamehere" (e.g. "https://yourprojectnamehere.localdomain").</p>
<ul>
<li>Please use these instructions to <a href="../install-demo-edit-hosts-file/">Edit the "/etc/hosts" File</a>.</li>
</ul>
<hr />
<h2 id="step-2-setup-git-for-the-isle-project">Step 2: Setup Git for the ISLE Project</h2>
<p><strong>Please note:</strong> The commands given below are for command line usage of git. (GUI based clients such as the <a href="https://www.sourcetreeapp.com/">SourceTree App</a> may be easier for endusers to use for the git process.)</p>
<p>Each "suggested git repository name" (below) serves to clearly name and distinguish your ISLE code from your Islandora code. It's very important to understand that these are two separate code repositories, and not to confuse them.</p>
<p>Create the following two new, empty, private git repositories (if they do not already exist) within your git repository hosting service (e.g <a href="https://github.com">Github</a>, <a href="https://bitbucket.org/">Bitbucket</a>, <a href="https://gitlab.com">Gitlab</a>):</p>
<ol>
<li>ISLE project configuration repository<ul>
<li><strong>Suggested git repository name:</strong> <code>yourprojectnamehere-isle</code></li>
<li>This Git repository will hold your copy of the ISLE code along with your environment-specific customizations. Storing this in a private repository and following the workflow below will save you a lot of time and confusion.</li>
</ul>
</li>
<li>Islandora Drupal code repository<ul>
<li><strong>Suggested git repository name:</strong> <code>yourprojectnamehere-islandora</code></li>
<li>This Git repository will hold your copy of the Islandora Drupal code along with your site specific customizations. Storing this in a private repository and following the workflow below will save you a lot of time and confusion.</li>
</ul>
</li>
</ol>
<p>Clone this newly created ISLE project to your personal computer:</p>
<ul>
<li>Open a <code>terminal</code> (Windows: open <code>Git Bash</code>)</li>
<li>Navigate to a directory that will house your new ISLE project directory using the <code>cd</code> command.</li>
<li>
<p><strong>Example:</strong> <code>git clone https://yourgitproviderhere.com/yourinstitutionhere/yourprojectnamehere-isle.git</code></p>
</li>
<li>
<p>Navigate to the directory that was just created by the clone operation:</p>
<ul>
<li><code>cd /path/to/your/repository</code></li>
</ul>
</li>
<li>
<p>Add the ICG ISLE git repository as a git upstream:</p>
<ul>
<li><code>git remote add icg-upstream https://github.com/Islandora-Collaboration-Group/ISLE.git</code></li>
</ul>
</li>
<li>
<p>View your remotes:</p>
<ul>
<li><code>git remote -v</code></li>
</ul>
</li>
<li>
<p>You should now see the following:</p>
</li>
</ul>
<pre><code class="bash">icg-upstream    https://github.com/Islandora-Collaboration-Group/ISLE.git (fetch)
icg-upstream    https://github.com/Islandora-Collaboration-Group/ISLE.git (push)
origin  https://yourgitproviderhere.com/yourinstitutionhere/yourprojectnamehere-isle.git (fetch)
origin  https://yourgitproviderhere.com/yourinstitutionhere/yourprojectnamehere-isle.git (push)
</code></pre>

<ul>
<li>
<p>Run a git fetch</p>
<ul>
<li><code>git fetch icg-upstream</code></li>
</ul>
</li>
<li>
<p>Pull down the ICG ISLE "master" branch into your local project's "master" branch</p>
<ul>
<li><code>git pull icg-upstream master</code></li>
</ul>
</li>
<li>
<p>View the ISLE code you now have in this directory:</p>
<ul>
<li><code>ls -lha</code></li>
</ul>
</li>
<li>
<p>Push this code to your online git provider ISLE</p>
<ul>
<li><code>git push -u origin master</code></li>
<li>This will take 2-5 minutes depending on your internet speed.</li>
</ul>
</li>
<li>
<p>Now you have the current ISLE project code checked into git as a foundation to make changes specific to your local and project needs. You'll use this git "icg-upstream" process in the future to pull updates and releases from the main ISLE project.</p>
</li>
</ul>
<h3 id="step-2a-add-customizations-from-step-0-to-the-git-workflow">Step 2a: Add Customizations from "Step 0" to the Git Workflow</h3>
<p>This step is intended for users who followed either the "<strong>Intermediate</strong>" or "<strong>Advanced</strong>" migration options in "Step 0" above.  If you choose the <strong>Easy</strong> migration option you may safely skip <code>Step 2a</code>.</p>
<p>Navigate to your local "ISLE" directory</p>
<ul>
<li><code>cd /path/to/your/repository</code></li>
</ul>
<p>Create new directories under "./config" to hold the Solr and GSearch files you retrieved in "Step 0".  Do the following::</p>
<pre><code>mkdir -p ./config/solr
mkdir -p ./config/fedora/gsearch
</code></pre>

<ul>
<li>
<p>Copy your "schema.xml" file from "Step 0" into the new "./config/solr/" directory.</p>
</li>
<li>
<p>Copy your "foxmltoSolr.xslt" file and "islandora_transforms" directory from "Step 0" into the "config/fedora/gsearch/" directory.</p>
</li>
<li>
<p>Add a new line in the Solr volumes section of your "docker-compose.local.yml"  </p>
</li>
</ul>
<pre><code>  - config/solr/schema.xml:/usr/local/solr/collection1/conf/schema.xml`  
</code></pre>

<ul>
<li>Add new lines in the Fedora volumes section of your "docker-compose.local.yml"  </li>
</ul>
<pre><code>  - ./config/fedora/gsearch/islandora_transforms:/usr/local/tomcat/webapps/fedoragsearch/WEB-INF/classes/fgsconfigFinal/index/FgsIndex/islandora_transforms
  - ./config/fedora/gsearch/foxmlToSolr.xslt:/usr/local/tomcat/webapps/fedoragsearch/WEB-INF/classes/fgsconfigFinal/index/FgsIndex/foxmlToSolr.xslt
</code></pre>

<p>Continue the local setup as directed below and ultimately import some objects from your existing Fedora repository and see if they display properly in searches as you like.</p>
<hr />
<h2 id="step-3-git-clone-the-production-islandora-drupal-site-code">Step 3: Git Clone the Production Islandora Drupal Site Code</h2>
<p>This step assumes you have an existing Islandora Drupal site checked into a git repository. (If not, then you'll need to check your Drupal site into a git repository following the same commands from <a href="../install-local-new/">Local ISLE Installation: New Site</a> documentation.)</p>
<p><strong>Note:</strong> If below you see a "fatal: Could not read from remote repository." error, then please read <a href="../install-troubleshooting/#fatal-could-not-read-from-remote-repository">Fatal: Could not read from remote repository</a>.</p>
<p><em>Using the same open terminal:</em></p>
<ul>
<li>Create a location outside of your ISLE directory where your Islandora Drupal site code will be stored.
  While you may create this location anywhere, we suggest that you put it at the same level as your existing ISLE directory. From your ISLE directory, go up one level:<ul>
<li><code>cd ..</code></li>
<li><code>git clone https://yourgitproviderhere.com/yourinstitutionhere/yourprojectnamehere-islandora.git</code></li>
<li><strong>Example:</strong> The above process created a folder named "yourprojectnamehere-islandora"</li>
</ul>
</li>
<li>Now update the "docker-compose.local.yml" in the ISLE repository to create a bind-mount to the Islandora Drupal site code:<ul>
<li>Search for "apache:"</li>
<li>Find the sub-section called "volumes:"</li>
<li>Find this line:<ul>
<li>"- ./data/apache/html:/var/www/html:cached"</li>
</ul>
</li>
<li>Edit the above line to be like this:<ul>
<li><code>- ../yourprojectnamehere-islandora:/var/www/html:cached</code></li>
</ul>
</li>
</ul>
</li>
<li>Your Production Islandora site code is now configured to be used in this local setup.</li>
</ul>
<hr />
<h2 id="step-4-edit-the-env-file-to-change-to-the-local-environment">Step 4: Edit the ".env" File to Change to the Local Environment</h2>
<ul>
<li>
<p>Navigate to your ISLE project directory.</p>
</li>
<li>
<p>Open the ".env" file in a text editor.</p>
</li>
<li>
<p>Change only the following lines in the ".env" file so that the resulting values look like the following: <strong>Please note: the following below is an example not actual values you should use. Use one word to describe your project and follow the conventions below accordingly</strong></p>
<ul>
<li><code>COMPOSE_PROJECT_NAME=yourprojectnamehere_local</code></li>
<li><code>BASE_DOMAIN=yourprojectnamehere.localdomain</code></li>
<li><code>CONTAINER_SHORT_ID=ld</code> <em>leave default setting of <code>ld</code> as is. Do not change.</em></li>
<li><code>COMPOSE_FILE=docker-compose.local.yml</code></li>
</ul>
</li>
<li>
<p>Save and close the file.</p>
</li>
<li>
<p>Additionally, depending on your decision from "Step 0", you may need to make additional edits to <code>docker-compose.local.yml</code> and move files into place as directed from the (<strong>Intermediate</strong>) and (<strong>Advanced</strong>) sections.</p>
</li>
</ul>
<p><strong>Please note:</strong> If you want to use a MySQL client with a GUI to import the Production MySQL Drupal database you'll need to uncomment the <code>ports</code> section of the MySQL service within the <code>docker-compose.local.yml</code> to make it so you can access port <code>3306</code> from the host computer. If you are already running MySQL on your personal computer, you'll have a port conflict and will need to either shutdown that service prior to running ISLE or change <code>3306:3306</code> to something like <code>9306:3306</code>. Please double-check.</p>
<p><strong>Please note:</strong> We highly recommend that you also review the contents of the <code>docker-compose.local.yml</code> file as the Apache service volume section uses bind mounts for the intended Drupal Code instead of using default Docker volumes. This allows users to perform Local Islandora Drupal site development with an IDE. This line is a suggested path and users are free to change values to the left of the <code>:</code> to match their Apache data folder of choice. However we recommend starting out with the default setting below.
Default: <code>- ./data/apache/html:/var/www/html:cached</code></p>
<hr />
<h2 id="step-5-create-new-users-and-passwords-by-editing-localenv-file">Step 5: Create New Users and Passwords by Editing "local.env" File</h2>
<p>You can reuse some of the older Production settings in the "local.env" if you like (e.g. the database name "DRUPAL_DB", database user "DRUPAL_DB_USER" even the drupal database user password "DRUPAL_DB_PASS" if that makes it easier). It is important to avoid repeating passwords in the ISLE Staging and Production environments.</p>
<ul>
<li>
<p>Open the "local.env" file in a text editor.</p>
<ul>
<li>Find each comment that begins with: <code># Replace this comment with a ...</code> and follow the commented instructions to edit the passwords, database and user names.<ul>
<li><strong>Review carefully</strong> as some comments request that you replace with <code>...26 alpha-numeric characters</code> while others request that you create an <code>...easy to read but short database name</code>.</li>
<li>In many cases the username is already pre-populated. If it doesn't have a comment directing you to change or add a value after the <code>=</code>, then don't change it.</li>
</ul>
</li>
<li>Once finished, save and close the file.</li>
</ul>
</li>
<li>
<p>Open the "config/apache/settings_php/settings.local.php" file in a text editor.</p>
<ul>
<li>Find the first comment that begins with: <code># ISLE Configuration</code> and follow the commented instructions to edit the database, username and password.</li>
<li>Find the second comment that begins with: <code># ISLE Configuration</code> and follow the instructions to edit the Drupal hash salt.</li>
<li>Once finished, save and close the file.</li>
</ul>
</li>
</ul>
<hr />
<h2 id="step-6-create-new-self-signed-certs-for-your-project">Step 6: Create New Self-Signed Certs for Your Project</h2>
<ul>
<li>
<p>Open the appropriate file in a text editor:</p>
<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> "./scripts/proxy/ssl-certs/local.sh"</li>
<li><strong>For Microsoft Windows:</strong> "./scripts/proxy/ssl-certs/local-windows-only.sh"</li>
</ul>
</li>
<li>
<p>Follow the in-line instructions to add your project's name to the appropriate areas.</p>
<ul>
<li>Once finished, save and close the file.</li>
</ul>
</li>
<li>
<p><em>Using the same open terminal:</em>, navigate to "/pathto/yourprojectnamehere/scripts/proxy/ssl-certs/"</p>
<ul>
<li><code>cd ./scripts/proxy/ssl-certs/</code></li>
</ul>
</li>
<li>
<p>Change the permissions on the script to make it executable</p>
<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> <code>chmod +x local.sh</code></li>
<li><strong>For Microsoft Windows:</strong> <code>chmod +x local-windows-only.sh</code></li>
</ul>
</li>
<li>
<p>Run the following command to generate new self-signed SSL keys using your "yourprojectnamehere.localdomain" domain. This now secures the local site.</p>
<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> <code>./local.sh</code></li>
<li><strong>For Microsoft Windows:</strong> <code>./local-windows-only.sh</code></li>
<li>The generated keys can now be found in:<ul>
<li><code>cd ../../../config/proxy/ssl-certs</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Add the SSL .pem and .key file names generated from running the above script to the "./config/proxy/traefik.local.toml" file.</p>
<ul>
<li><code>cd ..</code></li>
<li>Open <code>traefik.local.toml</code> in a text editor.</li>
<li><strong>Example:</strong><ul>
<li><code>certFile = "/certs/yourprojectnamehere.localdomain.pem"</code></li>
<li><code>keyFile = "/certs/yourprojectnamehere.localdomain.key"</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<h2 id="step-7-download-the-isle-images">Step 7: Download the ISLE Images</h2>
<ul>
<li>Download all of the latest ISLE Docker images (<em>~6 GB of data may take 5-10 minutes</em>):</li>
<li><em>Using the same open terminal:</em><ul>
<li>Navigate to the root of your ISLE project</li>
<li><code>cd ~/pathto/yourprojectnamehere</code></li>
<li><code>docker-compose pull</code></li>
</ul>
</li>
</ul>
<h2 id="step-8-launch-process">Step 8: Launch Process</h2>
<ul>
<li>
<p><em>Using the same open terminal:</em></p>
<ul>
<li><code>docker-compose up -d</code></li>
</ul>
</li>
<li>
<p>Please wait a few moments for the stack to fully come up. Approximately 3-5 minutes.</p>
</li>
<li>
<p><em>Using the same open terminal:</em></p>
<ul>
<li>View only the running containers: <code>docker ps</code></li>
<li>View all containers (both those running and stopped): <code>docker ps -a</code></li>
<li>All containers prefixed with "isle-" are expected to have a "STATUS" of "Up" (for x time).</li>
<li><strong>If any of these are not "UP", then use <a href="../install-troubleshooting/#non-running-docker-containers">Non-Running Docker Containers</a> to solve before continuing below.</strong>
  <!---TODO: This could be confusing if (a) there are other, non-ISLE containers, or (b) the isle-varnish container is installed but intentionally not running, oe (c) older exited ISLE containers that maybe should be removed. ---></li>
</ul>
</li>
</ul>
<h2 id="step-9-import-the-production-mysql-drupal-database">Step 9: Import the Production MySQL Drupal Database</h2>
<p><strong>Method A: Use a MySQL client with a GUI</strong></p>
<ul>
<li>Configure the client with the following:<ul>
<li>Host = <code>127.0.0.1</code></li>
<li>Port: <code>3306</code> <em>or a different port if you changed it</em></li>
<li>Username: <code>root</code></li>
<li>Password: <code>YOUR_MYSQL_ROOT_PASSWORD</code> in the "local.env")</li>
</ul>
</li>
<li>Select the Drupal database "DRUPAL_DB" in the "local.env")</li>
<li>Click File &gt; Import (<em>or equivalent</em>)</li>
<li>Select your exported Production Islandora Drupal database file (e.g. "prod_drupal_site_082019.sql.gz")</li>
<li>The import process will take 1 -3 minutes depending on the size.</li>
</ul>
<p><strong>Method B: Use the command line</strong></p>
<ul>
<li>
<p>Copy the Production Islandora Drupal database file (e.g. "prod_drupal_site_082019.sql.gz") to your ISLE MySQL container</p>
<ul>
<li>Run <code>docker ps</code> to determine the mysql container name</li>
<li><code>docker cp /pathto/prod_drupal_site_082019.sql.gz your-mysql-containername:/prod_drupal_site_082019.sql.gz</code></li>
<li><strong>Example:</strong><ul>
<li><code>docker cp /c/db_backups/prod_drupal_site_082019.sql.gz isle-mysql-ld:/prod_drupal_site_082019.sql.gz</code></li>
</ul>
</li>
<li>This might take a few minutes depending on the size of the file.</li>
</ul>
</li>
<li>
<p>Shell into the mysql container by copying and pasting the appropriate command:</p>
<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> <code>docker exec -it your-mysql-containername bash</code></li>
<li><strong>For Microsoft Windows:</strong> <code>winpty docker exec -it your-mysql-containername bash</code></li>
</ul>
</li>
<li>Import the Production Islandora Drupal database. Replace the "DRUPAL_DB_USER" and "DRUPAL_DB" in the command below with the values found in your "local.env" file.<ul>
<li><code>mysql -u DRUPAL_DB_USER -p DRUPAL_DB &lt; prod_drupal_site_082019.sql.gz</code></li>
</ul>
</li>
<li>This might take a few minutes depending on the size of the file.</li>
<li>Type <code>exit</code> to exit the container</li>
</ul>
<hr />
<h2 id="step-10-run-islandora-drupal-site-scripts">Step 10: Run Islandora Drupal Site Scripts</h2>
<p>This step will show you how to run the "migration_site_vsets.sh" script on the Apache container to change Drupal database site settings for ISLE connectivity.</p>
<p><em>Using the same open terminal:</em></p>
<ul>
<li>Run <code>docker ps</code> to determine the apache container name</li>
<li>Copy the "migration_site_vsets.sh" to the root of the Drupal directory on your Apache container<ul>
<li><code>docker cp scripts/apache/migration_site_vsets.sh your-apache-containername:/var/www/html/migration_site_vsets.sh</code></li>
</ul>
</li>
<li>Change the permissions on the script to make it executable<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> <code>docker exec -it your-apache-containername bash -c "chmod +x /var/www/html/migration_site_vsets.sh"</code></li>
<li><strong>For Microsoft Windows:</strong> <code>winpty docker exec -it your-apache-containername bash -c "chmod +x /var/www/html/migration_site_vsets.sh"</code></li>
</ul>
</li>
<li>Run the script<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> <code>docker exec -it your-apache-containername bash -c "cd /var/www/html &amp;&amp; ./migration_site_vsets.sh"</code></li>
<li><strong>For Microsoft Windows:</strong> <code>winpty docker exec -it your-apache-containername bash -c "cd /var/www/html &amp;&amp; ./migration_site_vsets.sh"</code></li>
</ul>
</li>
</ul>
<p>Since you've imported an existing Drupal database, you must now reinstall the Islandora solution packs so the Fedora repository will be ready to ingest objects.</p>
<ul>
<li>Copy the "install_solution_packs.sh" to the root of the Drupal directory on your Apache container<ul>
<li><code>docker cp scripts/apache/install_solution_packs.sh your-apache-containername:/var/www/html/install_solution_packs.sh</code></li>
</ul>
</li>
<li>Change the permissions on the script to make it executable<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> <code>docker exec -it your-apache-containername bash -c "chmod +x /var/www/html/install_solution_packs.sh"</code></li>
<li><strong>For Microsoft Windows:</strong> <code>winpty docker exec -it your-apache-containername bash -c "chmod +x /var/www/html/install_solution_packs.sh"</code></li>
</ul>
</li>
<li>Run the script<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> <code>docker exec -it your-apache-containername bash -c "cd /var/www/html &amp;&amp; ./install_solution_packs.sh"</code></li>
<li><strong>For Microsoft Windows:</strong> <code>winpty docker exec -it your-apache-containername bash -c "cd /var/www/html &amp;&amp; ./install_solution_packs.sh"</code></li>
</ul>
</li>
<li>The above process will take a few minutes depending on the speed of your local and Internet connection.<ul>
<li>You should see a lot of green [ok] messages.</li>
<li>If the script appears to pause or prompt for "y/n", DO NOT enter any values; the script will automatically answer for you.</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Microsoft Windows</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">You may be prompted by Windows to:</td>
</tr>
<tr>
<td align="left">- Share the C drive with Docker.  Click Okay or Allow.</td>
</tr>
<tr>
<td align="left">- Enter your username and password. Do this.</td>
</tr>
<tr>
<td align="left">- Allow vpnkit.exe to communicate with the network.  Click Okay or Allow (accept default selection).</td>
</tr>
<tr>
<td align="left">- If the process seems to halt, check the taskbar for background windows.</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Proceed only after this message appears:</strong> "Done. 'all' cache was cleared."</li>
</ul>
<hr />
<h2 id="step-11-test-the-site">Step 11: Test the Site</h2>
<ul>
<li>In your web browser, enter this URL: <code>https://yourprojectnamehere.localdomain</code></li>
</ul>
<!--- TODO: Add error message and how to proceed (click 'Advanced...') --->

<ul>
<li>
<p>Note: You may see an SSL error warning that the site is unsafe. It is safe, it simply uses "self-signed" SSL certs. Ignore the error and proceed to the site.</p>
</li>
<li>
<p>Log in to the local Islandora site with the credentials ("DRUPAL_ADMIN_USER" and "DRUPAL_ADMIN_PASS") you created in "local.env".</p>
<ul>
<li>You can also attempt to use login credentials that the Production server would have stored in its database.</li>
</ul>
</li>
<li>
<p>If the newly created Drupal login doesn't work then, you'll need to Shell into the Apache container:</p>
<ul>
<li><strong>For Mac/Ubuntu/CentOS/etc:</strong> <code>docker exec -it your-apache-containername bash</code></li>
<li><strong>For Microsoft Windows:</strong> <code>winpty docker exec -it your-apache-containername bash</code></li>
</ul>
</li>
<li>
<p>Navigate to this directory</p>
<ul>
<li><code>cd /var/www/html</code></li>
</ul>
</li>
<li>
<p>Create the user found in "DRUPAL_ADMIN_USER" and set its password to the value of "DRUPAL_ADMIN_PASS" as you previously created in "local.env". </p>
<ul>
<li>
<p>In the example below swap-out "DRUPAL_ADMIN_USER" and "DRUPAL_ADMIN_PASS" with those found in "local.env".</p>
</li>
<li>
<p><code>drush user-create DRUPAL_ADMIN_USER --mail="youremailaddresshere" --password="DRUPAL_ADMIN_PASS";</code></p>
</li>
<li>
<p><code>drush user-add-role "administrator" DRUPAL_ADMIN_USER</code></p>
</li>
</ul>
</li>
<li>
<p>Type <code>exit</code> to exit the container</p>
</li>
<li>
<p>Attempt to login again</p>
</li>
</ul>
<hr />
<h2 id="step-12-ingest-sample-objects">Step 12: Ingest Sample Objects</h2>
<p>It is recommended that endusers migrating their sites opt to either import sample objects from their non-ISLE Production Fedora servers or use the following below:</p>
<p>The Islandora Collaboration Group provides a set of <a href="https://github.com/Islandora-Collaboration-Group/islandora-sample-objects">Islandora Sample Objects</a> with corresponding metadata for testing Islandora's ingest process. These sample objects are organized by solution pack and are zipped for faster bulk ingestion.</p>
<ul>
<li>To download these sample objects, clone them to your computer's desktop:</li>
</ul>
<pre><code>git clone https://github.com/Islandora-Collaboration-Group/islandora-sample-objects.git
</code></pre>

<ul>
<li>
<p>Follow these ingestion instructions <a href="https://wiki.duraspace.org/display/ISLANDORA/How+to+Add+an+Item+to+a+Digital+Collection">How to Add an Item to a Digital Collection</a></p>
</li>
<li>
<p>(Note: <a href="https://wiki.duraspace.org/display/ISLANDORA/Getting+Started+with+Islandora">Getting Started with Islandora</a> contains explanations about content models, collections, and datastreams.)</p>
</li>
<li>
<p>After ingesting content, you may need to add an Islandora Simple Search block to the Drupal structure. (The default search box will only search Drupal content, not Islandora content.) This might already exist in your current Drupal Production site as a feature.</p>
<ul>
<li>
<p>Select from the menu: <code>Structure &gt; Blocks &gt; Islandora Simple Search</code></p>
</li>
<li>
<p>Select: <code>Sidebar Second</code></p>
</li>
<li>
<p>Click: <code>Save Blocks</code> at bottom of page</p>
</li>
<li>
<p>You may now search for ingested objects that have been indexed by SOLR</p>
</li>
</ul>
</li>
<li>
<p>After ingesting either the ICG sample objects or a selection of your pre-existing Fedora Production objects, continue to QC the migrated site, ensuring that objects display properly, the theme and design continue to work properly, there are no errors in the Drupal watchdog and everything matches the functionality of the previous non-ISLE Production Islandora Drupal site.</p>
</li>
</ul>
<hr />
<h2 id="next-steps">Next Steps</h2>
<p>Once you are ready to deploy your finished Drupal site, you may progress to:</p>
<ul>
<li><a href="../install-staging-migrate/">Staging ISLE Installation: Migrate Existing Islandora Site</a></li>
</ul>
<hr />
<h2 id="additional-resources">Additional Resources</h2>
<ul>
<li><a href="../install-environments/">ISLE Installation: Environments</a> helps explain the ISLE workflow structure, the associated files, and what values ISLE endusers should use for the ".env", "local.env", etc.</li>
<li><a href="../install-local-resources/">Local ISLE Installation: Resources</a> contains Docker container passwords and URLs for administrator testing.</li>
<li><a href="../install-troubleshooting/">ISLE Installation: Troubleshooting</a> contains help for port conflicts, non-running Docker containers, etc.</li>
</ul>
<hr />
<h3 id="end-of-local-isle-installation-migrate-existing-islandora-site">End of Local ISLE Installation: Migrate Existing Islandora Site</h3>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../install-local-new/" title="Local: New Site" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Local: New Site
              </span>
            </div>
          </a>
        
        
          <a href="../install-staging-new/" title="Staging: New Site" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Staging: New Site
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../extra.js"></script>
      
    
  </body>
</html>