<VirtualHost *:80>
  ServerAdmin admin@enduser_institution.com                         # enduser please edit this and then remove this comment
  ServerName fedora.enduser_institution.com                                # enduser please edit this and then remove this comment
  ServerAlias fedora

  ErrorLog /var/log/apache2/fedora.enduser_institution.com.error.log       # enduser please edit this
  CustomLog /var/log/apache2/fedora.enduser_institution.com.log combined   # enduser please edit this


  RewriteCond   %{SERVER_PORT} ^80$
  RewriteRule   ^(.*)$ https://%{SERVER_NAME}$1 [L,R]

  # Apache Reverse Proxy for Islandora
  ProxyRequests Off
  ProxyPreserveHost On
  <Proxy *>
    AddDefaultCharset off
    Order deny,allow
    Allow from all
  </Proxy>

  ProxyPass /adore-djatoka http://fedora:8080/adore-djatoka
  ProxyPassReverse /adore-djatoka http://fedora:8080/adore-djatoka

</VirtualHost>

<VirtualHost *:443>
  SSLEngine on
  SSLProtocol All -SSLv2 -SSLv3
  SSLCipherSuite ALL:!kRSA:!PSK:!SRP:!aNULL:!aECDH:!eNULL:!CAMELLIA:!IDEA:!SEED:!RC2:!RC4:!DES:!3DES:!EXP:!MD5:+AES256:+SHA384:+SHA256:+SHA1:+DH
  SSLHonorCipherOrder on
  SSLCompression off

  SSLCertificateFile                                                 # enduser please edit this
  SSLCertificateKeyFile                                              # enduser please edit this
  SSLCertificateChainFile                                            # enduser please edit this
  SSLCACertificateFile                                               # enduser please edit this

  ServerAdmin admin@enduser_institution.com                         # enduser please edit this and then remove this comment
  ServerName enduser_institution.com                                # enduser please edit this and then remove this comment
  ServerAlias fedora

  DocumentRoot /var/www/html
  ErrorLog /var/log/apache2/enduser_institution.com.error.log       # enduser please edit this
  CustomLog /var/log/apache2/enduser_institution.com.log combined   # enduser please edit this

  <Directory /var/www/html>
    Options FollowSymlinks
    AllowOverride all
  </Directory>

  RewriteEngine on
  RewriteOptions inherit

  # Apache Reverse Proxy for Islandora
  SSLProxyEngine On
  SSLProxyCheckPeerName On
  SSLProxyCACertificatePath "/etc/ssl/certs/"
  ProxyRequests Off
  ProxyPreserveHost On

  <Proxy *>
       AddDefaultCharset off
       Order deny,allow
       Allow from all
  </Proxy>

  ProxyPass /adore-djatoka https://fedora:8443/adore-djatoka
  ProxyPassReverse /adore-djatoka https://fedora:8443/adore-djatoka

</VirtualHost>
